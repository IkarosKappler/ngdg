{"version":3,"file":"uistats.js","sources":["../src/js/UIStats.js","../src/js/entry.js"],"sourcesContent":["\"use strict\";\n/**\n * This is a tiny UI module for displaying simple stats data.\n *\n * Not working with IEx. Use a 'Proxy' polyfill maybe?\n *\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy\n *\n * @author Ikaros Kappler\n * @date   2020-12-20\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n;\n/**\n * The default `Evaluator` function: identity (display values raw as they are).\n */\nvar FN_IDENTITY = function (value) { return value; };\n/**\n * The main class.\n *\n * Once instantiated it will append a new HTMLDivElement node to the DOM.\n */\nvar UIStats = /** @class */ (function () {\n    // @name LiveStats\n    // @constructor\n    // @param {object} observee\n    // @param {Object} keyToObserve (string->Object with props)\n    function UIStats(observee) {\n        // @member {object} Keeps the props for currently observed keys.\n        this.keyProps = {};\n        // @member {object}\n        this.keyProps = {};\n        // @member {number}\n        this.keyCount = 0;\n        // @member {object}\n        this.observee = observee;\n        this.root = document.createElement('div');\n        document.body.appendChild(this.root);\n        var _self = this;\n        this.toggled = false;\n        // Add header node\n        this.header = document.createElement('div');\n        this.header.addEventListener('click', function () { _self.__toggleVisibility(); });\n        this.root.appendChild(this.header);\n        this.__applyBaseLayout();\n        var proxyHandler = {\n            // get: function(target, prop, receiver) {\n            //    if( prop === 'message' )\n            //       return ...;\n            // }, \n            set: function (obj, propName, value) {\n                var kProps = _self.keyProps[propName];\n                if (typeof kProps !== \"undefined\") {\n                    var refinedValue = kProps.childElem.evaluateFn(value);\n                    _self.__applyKeyValue(propName, kProps, refinedValue);\n                }\n                return true; // Indicates change was successful\n            }\n        };\n        this.proxy = new Proxy(observee, proxyHandler);\n    }\n    ;\n    // @private\n    UIStats.prototype.__applyKeyValue = function (keyName, kProps, value) {\n        var node = document.getElementById(kProps.id);\n        node.innerHTML = value;\n        node.setAttribute('title', value);\n    };\n    ;\n    // @param {string} keyName\n    // @param {LiveStatsElem} newElem\n    UIStats.prototype.__updateChildElem = function (keyName, newElem) {\n        var kProps = this.keyProps[keyName];\n        if (typeof kProps !== \"undefined\") {\n            kProps.childElem = newElem;\n        }\n    };\n    ;\n    UIStats.prototype.add = function (keyName) {\n        var id = keyName + \"_\" + Math.floor(Math.random() * 65636);\n        // └-Root\n        //   └-Node\n        //     ├-Label\n        //     └-Content (with unique ID)\n        var node = document.createElement('div');\n        var label = document.createElement('div');\n        var content = document.createElement('div');\n        node.style.display = 'flex';\n        label.style.width = '50%';\n        label.style.color = '#0070ff';\n        this.__applyTextLayout(label);\n        label.innerHTML = keyName;\n        label.setAttribute('title', keyName);\n        content.style.width = '50%';\n        content.style.color = '#cccecb';\n        content.setAttribute('id', id);\n        this.__applyTextLayout(content);\n        node.appendChild(label);\n        node.appendChild(content);\n        this.root.appendChild(node);\n        // Gives the user the opportunity to tweak the output.\n        // Identity function is the default behavior.\n        var childElem = new UIStats.UIStatsChild(this, keyName, FN_IDENTITY);\n        this.keyProps[keyName] = { id: id, childElem: childElem };\n        this.keyCount++;\n        // Initially display the current value\n        this.__applyKeyValue(keyName, this.keyProps[keyName], this.observee[keyName]);\n        return childElem;\n    };\n    ;\n    // Toggles the main component on/off.\n    // @private\n    UIStats.prototype.__toggleVisibility = function () {\n        this.toggled = !this.toggled;\n        if (this.toggled) {\n            this.root.style.left = '-200px';\n            this.header.style.transform = 'rotate(180deg)';\n        }\n        else {\n            this.root.style.left = '0px';\n            this.header.style.transform = 'rotate(0deg)';\n        }\n    };\n    ;\n    // Avoid text from overflowing or breaking the bounds.\n    // @private\n    UIStats.prototype.__applyTextLayout = function (textNode) {\n        textNode.style.paddingLeft = '3px';\n        textNode.style.overflow = 'hidden';\n        textNode.style.whiteSpace = 'nowrap';\n        textNode.style.textOverflow = 'ellipsis';\n    };\n    ;\n    // @private\n    UIStats.prototype.__applyBaseLayout = function () {\n        this.root.style.position = 'absolute';\n        this.root.style.left = '0';\n        this.root.style.top = '0';\n        this.root.style.width = '200px';\n        this.root.style.background = '#1a1a1a'; // Like in dat.gui\n        this.root.style.fontFamily = 'Calibri, Arial, Helvetica';\n        this.root.style.fontSize = '12px';\n        this.root.style.transition = 'left 1s';\n        this.header.style.position = 'absolute';\n        this.header.style.display = 'flex';\n        this.header.style.justifyContent = 'center';\n        this.header.style.alignItems = 'center';\n        this.header.style.top = '0';\n        this.header.style.left = '100%';\n        this.header.style.width = '12px';\n        this.header.style.height = '12px';\n        this.header.style.borderRadius = '6px';\n        this.header.style.background = 'rgba(255,255,255,0.5)';\n        this.header.style.color = 'black';\n        this.header.style.fontSize = '6px';\n        this.header.style.cursor = 'pointer';\n        this.header.innerHTML = '&#9664;';\n    };\n    ;\n    // @param {UIStats} liveStats\n    // @param {string} keyName\n    // @param {function} evaluateFn - A function with one param: value => newValue\n    UIStats.UIStatsChild = /** @class */ (function () {\n        // Creates a new child.\n        function class_1(uiStats, keyName, evaluateFn) {\n            this.precision = function (precision) {\n                var _self = this;\n                return this.__installAsNewParent(function (value) {\n                    return Number(_self.evaluateFn(value)).toFixed(precision);\n                });\n            };\n            this.suffix = function (suffixText) {\n                var _self = this;\n                return this.__installAsNewParent(function (value) {\n                    return [_self.evaluateFn(value), suffixText].join('');\n                });\n            };\n            this.prefix = function (prefixText) {\n                var _self = this;\n                return this.__installAsNewParent(function (value) {\n                    return [prefixText, _self.evaluateFn(value)].join('');\n                });\n            };\n            this.uiStats = uiStats;\n            this.keyName = keyName;\n            this.evaluateFn = evaluateFn;\n        }\n        ;\n        class_1.prototype.__installAsNewParent = function (evaluateFn) {\n            var newChildElem = new UIStats.UIStatsChild(this.uiStats, this.keyName, evaluateFn);\n            this.uiStats.__updateChildElem(this.keyName, newChildElem);\n            return newChildElem;\n        };\n        ;\n        return class_1;\n    }()); // END nested class\n    return UIStats;\n}());\n;\nexports.default = UIStats;\n//# sourceMappingURL=UIStats.js.map","\"use strict\";\n/* Imports and exports for webpack */\n\n// Expose the component to the global scope\nglobalThis.UIStats = require(\"./UIStats.js\").default;\n"],"names":["require$$0"],"mappings":"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"}
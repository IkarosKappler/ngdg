!function(t,n,i,e){t=t||{};var o=Array.prototype.forEach?function(t,n,i){Array.prototype.forEach.call(t,n,i)}:function(t,n,i){for(var e=0,o=t.length;e<o;e++)e in t&&n.call(i,t[e],e,t)},s=Array.prototype.indexOf?function(t,n,i){return Array.prototype.indexOf.call(t,n,i)}:function(t,n,i){for(var e=i||0,o=t.length;e<o;e++)if(e in t&&t[e]===n)return e;return-1},r=Array.prototype.map?function(t,n,i){return Array.prototype.map.call(t,n,i)}:function(t,n,i){for(var e=t.length,o=new Array(e),s=0;s<e;s++)s in t&&(o[s]=n.call(i,t[s],s,t));return o},u=Array.prototype.filter?function(t,n,i){return Array.prototype.filter.call(t,n,i)}:function(t,n,i){for(var e,o=[],s=0,r=t.length;s<r;s++)e=t[s],s in t&&n.call(i,e,s,t)&&o.push(e);return o},a={};function h(t,n,i){if(t.addEventListener)t.addEventListener(n,i,!1);else if(t.attachEvent){var e=t.attachEvent("on"+n,i);a[e]={name:n,callback:i}}}function c(t,n,i){if(t.removeEventListener)t.removeEventListener(n,i,!1);else if(t.detachEvent)for(var e in a)a[e].name===n&&a[e].callback===i&&(t.detachEvent(e),delete a[e])}function m(t,n){var i,e=t.prototype,o=n.prototype;for(var s in o)e[s]=o[s];function r(t){var n=Array.prototype.slice.call(arguments,1);if(o[t])return o[t].apply(this,n)}e._super?(i=e._super,e._super=function(){i.call(this,arguments),r.call(this,arguments)}):e._super=r}function f(){this.onEvents={},this.onceEvents={}}function l(t){this._super("constructor"),this.id=t,this.lastPoint=null}function p(t){this._super("constructor"),this.fingers=t?r(t,function(t){return new l(t)}):[]}function d(t,n){return r(t,function(t){return{id:t.identifier,x:t.pageX,y:t.pageY,time:n}})}function v(t,n){return[{id:n,x:t.pageX,y:t.pageY,time:t.timeStamp}]}function y(t,n,i){void 0===i&&(i=n,n=!1),"function"==typeof i&&(i={any:i});for(var e in H)if(e in i){var o=H[e](t,i[e]);"function"==typeof o&&(o={any:o});for(var s in o)i[s]=s in i?function(t,n){return function(){t.call(this,arguments),n.call(this,arguments)}}(i[s],o[s]):o[s]}this.running=!1,this.elem=t,this.handleMouse=!!n,this.settings=i||{},this.mainHand=new p,this.multiHand=null,this.mouseID=null,this.start()}function g(t,n,i){return new y(t,n,i)}f.prototype.on=function(t,n){if(n){var i;if(t in this.onEvents){if(-1!=(i=s(this.onEvents[t],n)))return}else this.onEvents[t]=[];if(t in this.onceEvents)-1!=(i=s(this.onceEvents[t],n))&&this.onceEvents.splice(i,1);this.onEvents[t].push(n)}},f.prototype.once=function(t,n){if(n){var i;if(t in this.onceEvents){if(-1!=(i=s(this.onceEvents[t],n)))return}else this.onceEvents[t]=[];if(t in this.onEvents)-1!=(i=s(this.onEvents[t],n))&&this.onEvents.splice(i,1);this.onceEvents[t].push(n)}},f.prototype.off=function(t,n){if(n){var i;if(t in this.onEvents)if(-1!=(i=s(this.onEvents[t],n)))return void this.onEvents.splice(i,1);if(t in this.onceEvents)if(-1!=(i=s(this.onceEvents[t],n)))return void this.onceEvents.splice(i,1)}},f.prototype.trigger=function(t){for(var n,i=Array.prototype.slice.call(arguments,1),e=(this.onEvents[t]||[]).concat(this.onceEvents[t]||[]);n=e.shift();)n.apply(this,i)},m(l,f),m(p,f),p.prototype.get=function(t){var n;return o(this.fingers,function(i){i.id==t&&(n=i)}),n},y.prototype.start=function(){this.running||(this.running=!0,h(this.elem,"touchstart",this.touchstart()),h(this.elem,"touchmove",this.touchmove()),h(this.elem,"touchcancel",this.touchend()),h(this.elem,"touchend",this.touchend()),this.handleMouse&&(h(this.elem,"mousedown",this.mousedown()),h(this.elem,"mouseup",this.mouseup()),h(this.elem,"mouseout",this.mouseup()),h(this.elem,"mousemove",this.mousemove())))},y.prototype.stop=function(){this.running&&(this.running=!1,c(this.elem,"touchstart",this.touchstart()),c(this.elem,"touchmove",this.touchmove()),c(this.elem,"touchend",this.touchend()),c(this.elem,"touchcancel",this.touchend()),c(this.elem,"mousedown",this.mousedown()),c(this.elem,"mouseup",this.mouseup()),c(this.elem,"mouseout",this.mouseup()),c(this.elem,"mousemove",this.mousemove()))},y.prototype.touchstart=function(){if(!this._touchstart){var t=this;this._touchstart=function(n){var i=d(n.touches,n.timeStamp),e=d(n.changedTouches,n.timeStamp);t.mainHandStart(e),t.multiHandStart(e,i)}}return this._touchstart},y.prototype.touchmove=function(){if(!this._touchmove){var t=this;this._touchmove=function(n){var i=d(n.touches,n.timeStamp),e=d(n.changedTouches,n.timeStamp);t.mainHandMove(e),t.multiHandMove(e,i)}}return this._touchmove},y.prototype.touchend=function(){if(!this._touchend){var t=this;this._touchend=function(n){var i=d(n.touches,n.timeStamp),e=d(n.changedTouches,n.timeStamp);t.mainHandEnd(e),t.multiHandEnd(e,i)}}return this._touchend},y.prototype.mousedown=function(){if(!this._mousedown){var t=this;this._mousedown=function(n){var i;t.mouseID&&(i=v(n,t.mouseID),t.mainHandEnd(i),t.multiHandEnd(i,i),t.mouseID=null),t.mouseID=Math.random()+"",i=v(n,t.mouseID),t.mainHandStart(i),t.multiHandStart(i,i)}}return this._mousedown},y.prototype.mouseup=function(){if(!this._mouseup){var t=this;this._mouseup=function(n){if("mouseout"===n.type)for(var i=n.relatedTarget||n.toElement;i;){if(i===t.elem)return;i=i.parentNode}var e;t.mouseID&&(e=v(n,t.mouseID),t.mainHandEnd(e),t.multiHandEnd(e,e),t.mouseID=null)}}return this._mouseup},y.prototype.mousemove=function(){if(!this._mousemove){var t=this;this._mousemove=function(n){var i;t.mouseID&&(i=v(n,t.mouseID),t.mainHandMove(i),t.multiHandMove(i,i))}}return this._mousemove},y.prototype.mainHandStart=function(t){var n=this,i=[];o(t,function(t){var e=new l(t.id);e.lastPoint=t,i.push([e,t]),n.mainHand.fingers.push(e)}),o(i,function(t){n.settings.any&&n.settings.any.call(n,n.mainHand,t[0]),t[0].trigger("start",t[1])}),n.mainHand.trigger("start",t)},y.prototype.mainHandMove=function(t){var n=this,i=[];o(t,function(t){var e=n.mainHand.get(t.id);e&&(e.lastPoint=t,i.push([e,t]))}),o(i,function(t){t[0].trigger("move",t[1])}),n.mainHand.trigger("move",t)},y.prototype.mainHandEnd=function(t){var n=this,i=[];o(t,function(t){var e,o=n.mainHand.get(t.id);o&&(o.lastPoint=t,i.push([o,t]),e=s(n.mainHand.fingers,o),n.mainHand.fingers.splice(e,1))}),o(i,function(t){t[0].trigger("end",t[1])}),n.mainHand.trigger("end",t)},y.prototype.multiHandStart=function(t,n){this.multiHandDestroy(),this.multiHandRestart(n)},y.prototype.multiHandMove=function(t,n){var i=this,e=[];o(t,function(t){var n=i.multiHand.get(t.id);n&&(n.lastPoint=t,e.push([n,t]))}),o(e,function(t){t[0].trigger("move",t[1])}),i.multiHand.trigger("move",t)},y.prototype.multiHandEnd=function(t,n){this.multiHandDestroy();var i=u(n,function(n){var i=!0;return o(t,function(t){t.id==n.id&&(i=!1)}),i});this.multiHandRestart(i)},y.prototype.multiHandRestart=function(t){var n=this;if(0!=t.length){n.multiHand=new p;var i=[];o(t,function(t){var e=new l(t.id);e.lastPoint=t,i.push([e,t]),n.multiHand.fingers.push(e)});var e=n.settings[{1:"one",2:"two",3:"three",4:"four",5:"five"}[n.multiHand.fingers.length]];e&&e.apply(n,[n.multiHand].concat(n.multiHand.fingers)),o(i,function(t){t[0].trigger("start",t[1])}),n.multiHand.trigger("start",t)}},y.prototype.multiHandDestroy=function(){if(this.multiHand){var t=[];o(this.multiHand.fingers,function(n){var i=n.lastPoint;t.push(i),n.trigger("end",i)}),this.multiHand.trigger("end",t),this.multiHand=null}};var H={};g.plugin=function(t,n){if(t in H)throw"Touchy: "+t+" plugin already defined";H[t]=n};var E=function(t){t.preventDefault()};g.stopWindowBounce=function(){h(t,"touchmove",E)},g.startWindowBounce=function(){c(t,"touchmove",E)},t.Touchy=g,i&&i.extend(i.fn,{touchy:function(){var n=Array.prototype.slice.call(arguments);return this.forEach(function(i){var e=n.slice();e.unshift(this),g.apply(t,e)}),this}}),e&&(e.fn.touchy=function(){var n=Array.prototype.slice.call(arguments);this.each(function(){var i=n.slice();i.unshift(this),g.apply(t,i)})})}(window,document,window.Zepto,window.jQuery);
